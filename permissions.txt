# Lynx Platform Security Permissions

## API Key Permissions
- API keys can only be generated by authenticated users
- Each API key is unique and tied to a specific user account
- API keys can only be viewed by the user who created them
- API keys can only be used to create HTTPS tunnels for the owner's local network

## User Permissions
1. Unauthenticated Users
   - Can view the home page
   - Can register for a new account
   - Can log in to existing account
   - Cannot access dashboard
   - Cannot generate or view API keys
   - Cannot create HTTPS tunnels

2. Authenticated Users
   - Can access their personal dashboard
   - Can generate new API keys
   - Can view their own API keys
   - Can create HTTPS tunnels using their API keys
   - Can view their active tunnel status
   - Cannot view or manage other users' API keys
   - Cannot access other users' tunnels

## Firebase Security Rules
1. Authentication
   - Email/password authentication enabled
   - Email verification optional
   - Password reset functionality enabled

2. Firestore Collection Rules
   apiKeys Collection:
   ```
   match /apiKeys/{document} {
     allow read: if request.auth != null && resource.data.userId == request.auth.uid;
     allow create: if request.auth != null && request.resource.data.userId == request.auth.uid;
     allow delete: if request.auth != null && resource.data.userId == request.auth.uid;
     allow update: false;
   }
   ```

## HTTPS Tunnel Permissions
- Tunnels are only accessible on the local network
- Each tunnel is authenticated using the API key
- Tunnels cannot be accessed from outside the local network
- Only one active tunnel per API key at a time
- Tunnel ports are restricted to common development ports (3000-3999, 8000-8999)

## Rate Limiting
- API requests: 100 requests per 15 minutes per IP
- Tunnel creation: 10 attempts per hour per API key
- API key generation: 5 keys per 24 hours per user

## Security Headers
- CORS: Restricted to same origin
- Content Security Policy (CSP): Strict policy enforced
- X-Frame-Options: DENY
- X-Content-Type-Options: nosniff
- Strict-Transport-Security: max-age=31536000; includeSubDomains

## Server-Side Validations
- API keys must be valid UUID v4 format
- All requests must include valid API key authentication
- Request body size limited to 1MB
- Only allowed HTTP methods: GET, POST, OPTIONS
- Input sanitization enforced on all user inputs